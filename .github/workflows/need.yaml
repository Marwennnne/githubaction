name: anotther

on:
  pull_request:
  push:
    branches: [main]
    tags: [v*]
  workflow_dispatch:
    inputs:
      deploy:
        description: Set to `true` to deploy to K8s
        required: false


jobs:
  one:
    outputs:
      needs: ${{ steps.needs.outputs.needs }}
    runs-on: ubuntu-latest
    steps:
      - id: needs
        run: |
         echo "::set-output name=needs::{\"stack\":  'one' }"

  two:
    runs-on: ubuntu-latest
    steps:
      - run: |
         echo "::set-output name=matrix::{\"stack\":  'one' }"

  three:
    runs-on: ubuntu-latest
    needs: two
    if: |
      always() &&
      contains(needs.*.result, 'success') && 
      !contains(needs.*.result, 'failure')
    steps:
      - run: |
         echo "::set-output name=matrix::{\"stack\":  'one' }"

